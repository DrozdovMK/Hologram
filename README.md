# Holography practice


---
В этом репозитории содержится несколько скриптов и ноутбуков, каждый из которых отвечает за свои задачи.
---
1) Fresnel_Holo.py - скрипт для расчета интерференционных картин (голограмм Френеля) путем вычисления интеграла Френеля

В этом скрипте наиболее интересны две функции: 

* FrenelDifr - функция, на вход которой подаётся изображение (в нашем случае QR-код), и расстояние z на котором рассчитывается интеграл Френеля, также в качестве доп. параметров идет размер пикселя фотокамеры (по умолчанию 5.5 мкм), длина волны излучения (по умолчанию 532 нм). Кроме того в функцию подается параметр Reconstruct, который принимает значение True (режим реконструкции) или False (режим синтеза голограммы), данный параметр нужен для определения размеров отсчетов в плоскости изображения и плоскости распространения.
На выходе данной функции получаем интерференционную картинку (голограмму), записанную на расстоянии z. Тип чисел - комплексный.

* FullReconstruct - функция предназначенная для вызова в дальнейшем из ноутбука GenerateDataset. На вход подается изображение, в качестве доп. параметров: z_reg (расстояние на котором происходит запись и реконструкция голограммы, здесь предпологается что эти расстояния равны), размер пикселя, длина волны излучения, отношение средних по пикселям интенсивностей опорной и объектной волны, также параметр plotting (нужен для визуализаии при отладке).
На выходе данной функции получаем три 2d массива: (изображение, голограмма, восстановленное изображение). Все три массива представляют из себя интенсивности, полученные путем возведения полей в квадрат. Восстановленное изображение - прямой расчет дифракции Френеля голограммы с параметром Reconstruct = True.

2) GenerateDataset.ipynb - ноутбук для создания датасета QR-кодов и соответствующих голограмм. В этом ноутбуке наиболее важна функция:

* generate_dataset, которая cохраняет в указанные папки сгенерированные картинки. Создается три папки: qr_seq, holo_seq, fren_seq (приставка seq означает sequence - последовательность чисел). В каждой из этих папок есть папки train и val (для разбиения на тренировочную и валидационную выборку). Если в указанном пути нет вышеописанных папок, то они создаются.

3) TrainModel_QR.ipynb - ноутбук для тренировки модели. Для обучения модели используется библиотека PyTorch.

* class qr_dataset - класс в котором обозначен рецепт для взятия данных батчами (при обертке его потом в DataLoader).

* class AccuracyLoss - экспериментально проверялось обучение сети не минимзацией RMSE, а максимизацией Accuracy.

* train_model - функция, вызывающая процедуру обучения сети. На вход: обучаемая модель, DataLoader тренировочных данных, DataLoader валидационных данных, оптимизатор, лосс функция, кол-во эпох. Каждая эпоха записывается в pth формат, чтобы потом при использовании выбрать ту конфигурацию, которая лучше показала себя.

3) mu_unet.py - просто скрипт, в котором реализована сеть unet, в которой можно вручную править внутреннюю архитектуру сети.
